from libs.ds import Ds
import sys
import warnings
import argparse

if not sys.warnoptions:
    warnings.simplefilter('ignore')


def cim(output_format='CSV'):
    ds = Ds()
    ips_rules = ds.get_ips_rules()
    cve_ips_map = ds.get_cve_ips_map(ips_rules)
    ds.output_cve_ips_map(cve_ips_map, output_format)


def main():
    parser = argparse.ArgumentParser(description='Deep Security CVE to IPS rule mapper')
    parser.add_argument('--output-format', default='CSV', help='Output format - "CSV" or "JSON" (default: CSV)')
    args = parser.parse_args()
    output_format = args.output_format

    cim(output_format)


if __name__ == '__main__':
    main()
